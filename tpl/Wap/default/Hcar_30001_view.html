
<html>
    <head>
        <title>元旦快乐</title>
        <meta http-equiv="imagetoolbar" content="no">
        <meta charset="utf-8"> 
        <meta name="format-detection" content="telephone=no">
        <meta name="apple-mobile-web-app-capable" content="yes">
        <meta name="apple-mobile-web-app-status-bar-style" content="black">
        <meta name="viewport" content="width=device-width,height=device-height,inital-scale=1.0,maximum-scale=1.0,user-scalable=no;">
        <link rel="stylesheet" href="/tpl/Wap/default/common/hcar/makecard.css" type="text/css" media="screen" charset="utf-8">
        <script type="text/javascript">
            initViewport();
        </script>
        <script src='tpl/Wap/default/common/hcar/pic/30001/kawamovie.js?ver=10'></script>
        <style type="text/css">
        body{   
            -webkit-touch-callout: none; 
            -webkit-text-size-adjust: none;
            margin:0 auto;          
            overflow:hidden;   
            position:relative;          
            background:white;
        }
        #word_2,#word_0,#word_1,#word_5{
        	-webkit-transition:-webkit-transform 2s linear;
        }
        #qiu1,#qiu5,#qiu0_1{
        	-webkit-transition:-webkit-transform 4s linear;
        }
        #caidai1{
            -webkit-animation:CaiMove_1 3s linear infinite alternate; 
        }
        #caidai2{
            -webkit-animation:CaiMove_2 3s linear infinite alternate; 
        }
        #huaban{
            -webkit-transform-origin:30% 0%;
        }
        @-webkit-keyframes WordMove{
        	0%{
        		-webkit-transform:scale(1) translate(0px,0px);
        	}
        	100%{
        		-webkit-transform:scale(0.5) translate(-280px,-220px);
        	}
        }
        @-webkit-keyframes ballMove{
            0%{
                -webkit-transform:translate(0px,0px);
            }
            35%{
                -webkit-transform:translate(-4px,0px);
            }
            100%{
                -webkit-transform:translate(8px,0px);
            }
        }
        @-webkit-keyframes CaiMove_1{
            0%{
                -webkit-transform:translate(0px,0px);
            }

            100%{
                -webkit-transform:translate(-122px,-42px);
            }
        }
        @-webkit-keyframes CaiMove_2{
            0%{
                -webkit-transform:translate(0px,0px);
            }

            100%{
                -webkit-transform:translate(70px,0px);
            }
        }
        @-webkit-keyframes Word2Move{
            0%{
                -webkit-transform:translate(0px,-375px);
            }
            40%{
                -webkit-transform:translate(-4px,-375px);
            }
            100%{
                -webkit-transform:translate(8px,-375px);
            }
        }
        @-webkit-keyframes Word0Move{
            0%{
                -webkit-transform:translate(0px,-415px);
            }
            40%{
                -webkit-transform:translate(-4px,-415px);
            }
            100%{
                -webkit-transform:translate(8px,-415px);
            }
        }
        @-webkit-keyframes Word1Move{
            0%{
                -webkit-transform:translate(0px,-420px);
            }
            40%{
                -webkit-transform:translate(8px,-420px);
            }
            100%{
                -webkit-transform:translate(-4px,-420px);
            }
        }
        @-webkit-keyframes Word5Move{
            0%{
                -webkit-transform:rotate(-15deg) translate(-6px,0px);
            }
            35%{
                -webkit-transform:rotate(0deg);
            }
            65%{
                -webkit-transform:rotate(15deg) translate(7px,0px);
            }
            100%{
                -webkit-transform:rotate(0deg) ;
            }
        }

        </style>

        <script>
        function rand(min,max)
        {
            return min+Math.floor(Math.random()*(max-min+1));
        }
        function WordIn()
        {
        	setTimeout("objid('word_2').style.webkitTransform = 'translate(0px,-375px)';",300);
        	objid('word_0').style.webkitTransform = 'translate(0px,-415px)';
        	setTimeout("objid('word_1').style.webkitTransform = 'translate(0px,-420px)';",700);
        	objid('word_5').style.webkitTransform = 'translate(0px,-420px)';
        	setTimeout("objid('qiu0_1').style.webkitTransform = 'translate(0px,-665px)';",2000);
        	setTimeout("objid('qiu1').style.webkitTransform = 'translate(0px,-665px)';",2700);
        	setTimeout("objid('qiu5').style.webkitTransform = 'translate(0px,-665px)';",2000);
        }
        function WordMove()
        {
        	objid('happy').style.display = 'block';
        	setTimeout("objid('happy').style.webkitAnimation = 'WordMove 1.5s linear forwards';",1500);
        }
        function Hand()
        {
            objid('right1').style.display = 'none' ; 
            objid('right2').style.display = 'none' ;
            objid('huaban').style.display = 'block' ;  
        }
        function Ball()
        {
            // objid('qiu2_1').style.webkitAnimation = 'ballMove 2s linear infinite alternate' ; 
            // objid('qiu2_2').style.webkitAnimation = 'ballMove 2s  1s linear infinite alternate' ; 
            // objid('qiu2_3').style.webkitAnimation = 'ballMove 2s 1s linear infinite alternate' ;
            // objid('word2_1').style.webkitAnimation = 'Word2Move 2s linear infinite alternate' ;
            // objid('word2_2').style.webkitAnimation = 'Word2Move 2s linear infinite alternate' ;
            objid('word_2').style.webkitAnimation = 'Word2Move 2s linear infinite alternate' ;
            setTimeout(function()
            {
                objid('word_0').style.webkitAnimation = 'Word0Move 2s linear infinite alternate' ;
                objid('word_1').style.webkitAnimation = 'Word1Move 2s linear infinite alternate' ;
                objid('huaban').style.webkitAnimation = 'Word5Move 4s linear infinite alternate' ;
            }
            ,500);
        }
        function run()
        {   
            create_base();
            read_base();
            setTimeout(create_textdiv,6000);
            add_kawa_icon();
            create_music();
            create_modify();
            setTimeout(WordIn,500);
            setTimeout(WordMove,4000);
            setTimeout(Hand,3500);
            setTimeout(Ball,3500);
        }
        </script>
    </head>

    <body style='margin:0px' onload='run();'>
    	<script>
            words = '辞岁迎新同欢乐,欢庆时刻送祝福.快乐好运全涌来,财源滚滚挡不住.平安健康把你绕,幸福美满把你罩.浓浓情意把你围,祝你元旦节快乐!';
            
            kawa_data = {
                words              : words,
                <if condition=" $words eq ''">
				replace_words      : '辞岁迎新同欢乐,欢庆时刻送祝福.快乐好运全涌来,财源滚滚挡不住.平安健康把你绕,幸福美满把你罩.浓浓情意把你围,祝你元旦节快乐!',
				<else/>
                replace_words      : '{weimicms:$words}',</if>
                text_box           : '150 280 340 180', // 左 上 宽 高，空格分隔，只写数字，单位强制为px
                mode               : 'up',     // up, left
                speed              : 50,     // 每秒移动的像素
                text_color         : '#000000', // rgb(1,2,3) 'black'
                font_size          : '25pt',
                line_height        : '40pt',
                music              : 'tpl/Wap/default/common/hcar/sound/xiaobainian.mp3',     // url
               <if condition=" $music eq ''">
				replace_music      : 'tpl/Wap/default/common/hcar/sound/xiaobainian.mp3', 
				<else/> 
				 replace_music      : 'tpl/Wap/default/common/hcar/sound/{weimicms:$music}.mp3',</if>
                music_name         : '',
                replace_music_name : '#replace_music_name#',
                icon               : '{weimicms:$f_siteUrl}/tpl/Wap/default/common/hcar/pic/30001/m30001.jpg',
                title              : '送给你',
                desc               : words,
                modify             : 'no',
                replace_modify     : 'yes',
                cardid             : '30001',
                share_url          : window.location.href, // 当分享的是微信页面时才需要改这里
                font_ip            : '115.28.135.41:8000',
                font_family        : 'mctxmf',
                modify_optfile     : '10020',
                modify_optwords    : '#modify_optwords#',
                show_words         : 'yes',
            };  
        </script>
        <div id='body1' style='position:absolute;width:500px;height:815px;overflow:hidden;'>
        	<img src='tpl/Wap/default/common/hcar/pic/30001/2000.jpg' />
            <div id='caidai' style='position:absolute;top:10px;left:0px'>
                <img id='caidai1' src='tpl/Wap/default/common/hcar/pic/30001/200013.png' style='position:absolute;width:570px;left:50px;top:-20px;'/>
                <img id='caidai2' src='tpl/Wap/default/common/hcar/pic/30001/20006.png' style='position:absolute;width:630px;left:-70px;'/>
            </div>
        	<div id='word2015' style='position:absolute;left:80px;top:815px;'>
        		<div id='word_2' style='position:absolute;left:-20px;top:110px;'>
        			<img id='word2_1'src='tpl/Wap/default/common/hcar/pic/30001/20009.png' style='position:absolute;width:100px;'/>
                    <img id='qiu2_2' src='tpl/Wap/default/common/hcar/pic/30001/20005.png' style='position:absolute;left:-35px;top:-95px;width:55px;'/>
                    <img id='qiu2_1' src='tpl/Wap/default/common/hcar/pic/30001/200015.png' style='position:absolute;left:-12px;top:-90px;width:55px;'/>
                    <img id='qiu2_3' src='tpl/Wap/default/common/hcar/pic/30001/200014.png' style='position:absolute;left:-10px;top:-55px;width:55px;'/>
        			<img id='word2_2'src='tpl/Wap/default/common/hcar/pic/30001/20001.png' style='position:absolute;left:-6px;top:30px;width:20px;-webkit-transform:rotate(-20deg);'/>
        		</div>
        		<div id='word_0' style='position:absolute;left:80px;top:125px;'>
        			<img src='tpl/Wap/default/common/hcar/pic/30001/20004.png' style='position:absolute;width:100px;'/>
        			<img id='qiu0_1' src='tpl/Wap/default/common/hcar/pic/30001/200015.png' style='position:absolute;left:82px;top:-105px;width:55px;'/>
        			<img src='tpl/Wap/default/common/hcar/pic/30001/200011.png' style='position:absolute;left:86px;top:5px;width:20px;'/>
        			<img src='tpl/Wap/default/common/hcar/pic/30001/20001.png' style='position:absolute;left:-6px;top:-5px;width:20px;'/>
        		</div>
        		<div id='word_1' style='position:absolute;left:200px;top:150px;'>
        			<img src='tpl/Wap/default/common/hcar/pic/30001/2000.png' style='position:absolute;width:50px;'/>        			
        			<img id='qiu1' src='tpl/Wap/default/common/hcar/pic/30001/200015.png' style='position:absolute;left:33px;top:-115px;width:55px;'/>
        			<img src='tpl/Wap/default/common/hcar/pic/30001/200011.png' style='position:absolute;left:40px;top:-15px;width:20px;'/>
        	    </div>
        	    <div id='word_5' style='position:absolute;left:270px;top:135px;'>
        	    	<img src='tpl/Wap/default/common/hcar/pic/30001/20008.png' style='position:absolute;width:90px;'/>
                    <img id='right1' src='tpl/Wap/default/common/hcar/pic/30001/20002.png' style='position:absolute;left:69px;top:-5px;width:20px;'/>
        		    <img id='qiu5' src='tpl/Wap/default/common/hcar/pic/30001/200015.png' style='position:absolute;left:58px;top:-105px;width:55px;'/>
        	        <img id='right2' src='tpl/Wap/default/common/hcar/pic/30001/200011.png' style='position:absolute;left:72px;top:-5px;width:20px;'/>
        	    </div>
        	</div>
            <div id='huaban' style='position:absolute;width:130px;height:291px;left:415px;top:560px;display:none'>
                <img src='tpl/Wap/default/common/hcar/pic/30001/200010.png' style='position:absolute;width:60px;'>
                <img src='tpl/Wap/default/common/hcar/pic/30001/200012.png' style='position:absolute;width:130px;left:-55px;top:-190px;'>
                <img src='tpl/Wap/default/common/hcar/pic/30001/20003.png' style='position:absolute;width:70px;left:-25px;top:-170px;-webkit-transform:rotate(-15deg);'>
            </div>
        	<img id='happy' src='tpl/Wap/default/common/hcar/pic/30001/20007.png' style='position:absolute;left:80px;top:160px;width:320px;display:none' />
        		<!-- <img id='h' src='/pic/9601/2hhh_1.png' style='position:absolute;left:0px;top:0px;width:230px;' />
        		<img id='n' src='/pic/9601/2hhh_2.png' style='position:absolute;left:0px;top:80px;width:150px;' />
        		<img id='y' src='/pic/9601/2hhh_3.png' style='position:absolute;left:0px;top:150px;width:180px;' /> -->
            <div id='snow1'></div>
        </div>
        <script >
        kawa_images = {
                kawasnow:{url:'tpl/Wap/default/common/hcar/pic/30001/200016.png'},
        };

        pathsnow1 ='x0,y0,w0.7,h0.7->7->x200,y820,w0.7,h0.7';
        pathsnow ='x0,y0,->6->x200,y820';
        actionsnow = new_path_action(pathsnow,'linear infinite ');
        actionsnow1 = new_path_action(pathsnow1,'linear infinite ');
        actionin = new_opacity_action(0,1,1,'show','forwards');

        var num = 0;
        t=setInterval(function()
        {
            { 
            	if(num%3==0)
            	{
            		snow=new_sprite('kawasnow',rand(-100,450)+','+rand(-20,-10),false);
                    objid('snow1').appendChild(snow);
                    action_at_time(0,snow,actionin);
                    action_at_time(0,snow,actionsnow1);
            	}
            	else
            	{
            		snow=new_sprite('kawasnow',rand(-100,450)+','+rand(-20,-10),false);
                    objid('snow1').appendChild(snow);
                    action_at_time(0,snow,actionin);
                    action_at_time(0,snow,actionsnow);
            	}
            }
            num++;
            if(num>60) {clearInterval(t);}
        },100);            
        </script>

    </body>
   <script>
   note_id = 0;
win_height = 0;
music_player = new Audio();
pop_up_note_mode = true;

text_prepared = false;
font_img = null;

// pure_card_text

// ---------------------------------------------------------------------
// sdk

function add_keyframes(name, cssbody)
{
    csstext = '@-webkit-keyframes ' + name + '{' + cssbody + '}';

    style = document.createElement('style');
    document.head.appendChild(style);
    sheet = style.sheet;
    sheet.insertRule(csstext, 0);
}

function create_imgdiv(url, idname, visible, x, y)
{
    imgdiv = document.createElement('div');
}

function objid(idname)
{
    return document.getElementById(idname);
}

function _kv(value)
{
    if(typeof(value) == 'undefined')
    {
        return false;
    }

    if(value == '')
    {
        return false;
    }

    if(value.charAt(0) == '#')
    {
        return false;
    }

    return true;
}

function _v(keyname)
{
    if(typeof(kawa_data[keyname]) == 'undefined')
    {
        return '';
    }

    return kawa_data[keyname];
}

// ---------------------------------------------------------------------
// text

function kawa_init_async()
{
    read_base();
    create_textdiv();
    add_kawa_icon();
    create_music();
    //create_modify();
    <if condition=" $words eq ''">
            create_modify();</if>

}

function kawa_init()
{
    document.body.style.margin = '0px';
    create_base();
    setTimeout("kawa_init_async()", 100);
 }

function is_show_words()
{
    if(typeof(kawa_data.show_words) == 'undefined')
    {
        return true;
    }

    if(kawa_data.show_words != 'no')
    {
        return true;
    }

    return false;
}

function read_base()
{
    win_height = objid('basepoint').offsetTop;
}

function create_base()
{
    div = document.createElement('div');
    div.style.position = 'fixed';
    div.style.bottom = '0px';
    div.style.width = '1px';
    div.style.height = '1px';
    div.style.left = '-100px';
    div.id = 'basepoint';
    document.body.appendChild(div);
}

function make_text_animation()
{
    //if(!is_show_words())
    //    return;

    var mask = objid('textmask');
    var textdiv = objid('textdiv');

    if(kawa_data.mode == 'up')
    {
        var keycss = 'from{-webkit-transform:translate(0px, ' + mask.offsetHeight + 'px);}' +
                 'to{-webkit-transform:translate(0px, -' + textdiv.offsetHeight + 'px);}' 

        add_keyframes('textdivani', keycss);

        var dt = (mask.offsetHeight + textdiv.offsetHeight) / kawa_data.speed;

        textdiv.style.webkitAnimation = 'textdivani ' + dt + 's linear infinite';
    }
    else if(kawa_data.mode == 'left')
    {
        var keycss = 'from{-webkit-transform:translate(' + mask.offsetWidth + 'px, 0px);}' +
                 'to{-webkit-transform:translate(-' + textdiv.offsetWidth + 'px, 0px);}' 

        add_keyframes('textdivani', keycss);

        var dt = (mask.offsetWidth + textdiv.offsetWidth) / kawa_data.speed;

        textdiv.style.webkitAnimation = 'textdivani ' + dt + 's linear infinite';
    }
    else if (kawa_data.mode == 'print')
    {
        onPrint();
        setTimeout("onPrintAni()", 1500);
    }
}
function onPrint()
{
    objid('textdiv').style.top = objid('textmask').offsetHeight;
    gPrText          = card_text();
    gOrgCardText       = card_text();

}

function onPrintAni()
{
    pushText = '';
    
    var reachEnd = 0;
    
    if(gPrText.length <1)
    {
        reachEnd = 1;
    }
    
    var cutlen = 0;

    if(gPrText.length >= 4 && gPrText.substring(0, 4) == '<br>')
    {
        gPrText  = gPrText .substring(4);
        pushText = '<br>';
        cutlen = 4;
    }
    else if(gPrText.substring(0, 2) == '/:')
    {
        result = ConvFaceOnBegin(gPrText );
        cutlen = result[1];
        if(cutlen > 0)
        {
            gPrText  = gPrText .substring(cutlen);
            pushText = result[0];
        }
    }
    
    if(cutlen == 0 && gPrText.length >= 1)
    {
        pushText   = gPrText.substring(0, 1);
        gPrText  = gPrText.substring(1);
    }

    objid('textdiv').innerHTML = objid('textdiv').innerHTML + pushText;
    //alert(objid('textmask').offsetHeight);
    if((objid('textdiv').offsetTop + objid('textdiv').offsetHeight)> objid('textmask').offsetHeight)
    {
        trans = objid('textmask').offsetHeight - objid('textdiv').offsetHeight;
        objid('textdiv').style.top = trans+ 'px';
        //alert(objid('textdiv').style.top);
    }

    if(reachEnd == 1)
    {
        //setTimeout("", 2000); 
        
        setTimeout("pauseShow()",2000);
        
    }
    else
    {
        var gSpeed = kawa_data.speed;
        setTimeout("onPrintAni()", gSpeed);
    }
}
function pauseShow()
{
    reachEnd=0;
    trans = 0;
    objid('textdiv').style.top =trans+'px';
    gPrText              = gOrgCardText;
    objid('textdiv').innerHTML = "";
    setTimeout("onPrintAni()",1000);
}
function show_textdiv()
{
        var box = kawa_data.text_box.split(' ');

        var mask = document.createElement('div');
        mask.id = 'textmask';
        mask.style.position = 'absolute';
        mask.style.left     = box[0] + 'px';
        mask.style.top      = box[1] + 'px';
        mask.style.width    = box[2] + 'px';
        mask.style.height   = box[3] + 'px';
        mask.style.overflow = 'hidden';

        var textdiv = document.createElement('div');
        textdiv.id = 'textdiv';
        textdiv.style.position = 'absolute';
        textdiv.style.color = kawa_data.text_color;
        textdiv.style.fontSize  = kawa_data.font_size;
        
        textdiv.style.lineHeight = kawa_data.line_height;
        textdiv.style.fontWeight = '600';       
        textdiv.style.fontFamily = 'Microsoft YaHei';

        textdiv.style.zIndex = 50000;

        if(_kv(kawa_data.text_align))
        {
            textdiv.style.textAlign = kawa_data.text_align;
        }

        if(_kv(kawa_data.font_weight))
        {
            textdiv.style.fontWeight = kawa_data.font_weight;
        }

        if(kawa_data.mode == 'left')
        {
            textdiv.style.float = 'left';
        }

        document.body.appendChild(mask);    
        mask.appendChild(textdiv);

        set_up_words();
}

function create_textdiv()
{
    if(is_show_words())
    {
        show_textdiv();
    }
}

function set_up_words()
{
    if(_kv(kawa_data.font_family))
    {
        var text = pure_card_text();

        if(kawa_data.mode == 'up')
        {
            text = wrap_text(text);
        }

        var font_ip = 'aliyun7.kagirl.cn:8000';

        if(_kv(kawa_data.font_ip))
        {
            font_ip = kawa_data.font_ip;
        }

        var re_d = /^\d+/;
        var font_size = parseFloat(re_d.exec(kawa_data.font_size)[0]);
        var line_height = parseFloat(re_d.exec(kawa_data.line_height)[0]);
        var gap = line_height - font_size;

        var box = kawa_data.text_box.split(' ');

        var color = kawa_data.text_color.substring(1);

        var url = "http://" + font_ip + "/fontimg?words=" + encodeURIComponent(text) + "&fontname=" + 
            kawa_data.font_family + "&fontsize=" + font_size + "&gap=" + gap + "&width=" + box[2] + 
            "&color=" + color;

        font_img = document.createElement('Img');
        font_img.onload = on_font_img_load;
        font_img.src = url;
        setTimeout('on_check_font_img()', 1000);
    }
    else
    {
        textdiv = objid('textdiv');
        if (kawa_data.mode=='print')
            textdiv.innerHTML = '';
        else
            textdiv.innerHTML = card_text();
        make_text_animation();
    }
}

function on_font_img_load()
{
    if(!text_prepared)
    {
        text_prepared = true;
        var textdiv = objid('textdiv');
        textdiv.appendChild(font_img);
        make_text_animation();
    }
}

function on_check_font_img()
{
    if(!text_prepared)
    {
        var textdiv = objid('textdiv');
        text_prepared = true;
        var fontSize = parseInt(textdiv.style.fontSize);
        var lineHeight = parseInt(textdiv.style.lineHeight);
        textdiv.style.fontSize = fontSize*2/3 + textdiv.style.fontSize.substring(textdiv.style.fontSize.length-2,textdiv.style.fontSize.length);
        textdiv.style.lineHeight = lineHeight*2/3 + textdiv.style.lineHeight.substring(textdiv.style.lineHeight.length-2,textdiv.style.lineHeight.length);
        textdiv.innerHTML = card_text();
        make_text_animation();
    }
}

function pure_card_text()
{
    text = kawa_data.words;

    if(kawa_data.replace_words != '#replace_words#')
    {
        text = kawa_data.replace_words;
    }

    return text;
}

function card_text()
{
    text = pure_card_text();

    if((kawa_data.mode == 'up')||(kawa_data.mode == 'print'))
    {
        text = wrap_text(text);
    }
    else if(kawa_data.mode == 'left')
    {
        text = '<nobr>' + text + '</nobr>';
    }

    return text;
}

function wrap_text(in_text)
{
    text = in_text.replace(/,/g, ',<br>');
    text = text.replace(/锛�/g, '锛�<br>');
    text = text.replace(/\./g, '.<br>');
    text = text.replace(/銆�/g, '銆�<br>');
    text = text.replace(/;/g, ';<br>');
    text = text.replace(/锛�/g, '锛�<br>');
    text = text.replace(/!/g, '!<br>');
    text = text.replace(/锛�/g, '锛�<br>');
    text = text.replace(/锝�/g, '锝�<br>');
    text = text.replace(/锛�/g, '锛�<br>');
    text = text.replace(/:/g, ':<br>');    
    text = text.replace(/锛�/g, '锛�<br>');
    text = text.replace(/\?/g, ':<br>');
    return text;
}

// ---------------------------------------------------------------------
// kawa icon

function add_kawa_icon()
{
    url = 'tpl/Wap/default/common/hcar/kawa1.gif';

    div = document.createElement('div');
    img = document.createElement('img');
    img.src = url;
    div.appendChild(img);

    div.style.position = 'fixed';
    div.style.top = (win_height - 150) + 'px';
    //div.style.top = (700 - 20) + 'px';
    div.style.right = '10px';
    div.style.zIndex = '10000';
    //div.style.left = '10px';
    //alert('kawa');
    div.onclick = goto_kawa;

    document.body.appendChild(div);
}


function goto_kawa()
{
    location.href = '{weimicms:$fxlj}';
}

// ---------------------------------------------------------------------
// kawa music

var bplay = 0;              //璁板綍鏄惁瑕佹挱鏀鹃煶涔�
function switchsound()
{
    au = music_player
    ai = objid('sound_image');
    if(au.paused)
    {
        bplay = 1;
        au.play();
        ai.src = "tpl/Wap/default/common/hcar/music_note_big.png";
        pop_up_note_mode = true;
        popup_note();
        objid("music_txt").innerHTML = "鎵撳紑";
        objid("music_txt").style.visibility = "visible";
        setTimeout(function(){objid("music_txt").style.visibility="hidden"}, 2500);
    }
    else
    {
        bplay = 0;
        pop_up_note_mode = false;
        au.pause();
        ai.src = "tpl/Wap/default/common/hcar/music_note_big.png";
        objid("music_txt").innerHTML = "鍏抽棴";
        objid("music_txt").style.visibility = "visible";
        setTimeout(function(){objid("music_txt").style.visibility="hidden"}, 2500);
    }
}

function play_music()
{
    if(typeof(kawa_data) != 'undefined')
    {
        music = kawa_data.music;

        if(kawa_data.replace_music != '#replace_music#')
        {
            music = kawa_data.replace_music;
        }

        music_player.src = music;
        music_player.loop = 'loop';
        music_player.play();
        bplay = 1;
    }
}

function create_music()
{
    play_music();

    sound_div = document.createElement("div");
    sound_div.setAttribute("ID", "cardsound");
    sound_div.style.cssText = "position:fixed;right:20px;top:25px;z-index:50000;visibility:visible;";
    sound_div.onclick = switchsound;
    bg_htm = "<img id='sound_image' src='tpl/Wap/default/common/hcar/music_note_big.png'>";
    box_htm = "<div id='note_box' style='height:100px;width:44px;position:absolute;left:0px;top:-80px'></div>";
    txt_htm = "<div id='music_txt' style='color:white;position:absolute;left:-40px;top:30px;width:60px'></div>"
    sound_div.innerHTML = bg_htm + box_htm + txt_htm;
    document.body.appendChild(sound_div);

    setTimeout("popup_note()", 100);
}   
function on_pop_note_end(event)
{
    note = event.target;
    
    if(note.parentNode == objid("note_box"))
    {
        objid("note_box").removeChild(note);
    }
}

function popup_note()
{
    box = objid("note_box");
    
    note = document.createElement("span");
    note.style.cssText = "visibility:visible;position:absolute;background-image:url('tpl/Wap/default/common/hcar/music_note_small.png');width:15px;height:25px";
    note.style.left = Math.random() * 20 + 20;
    note.style.top = "75px";
    this_node = "music_note_" + note_id;
    note.setAttribute("ID", this_node);
    note_id += 1;
    scale = Math.random() * 0.4 + 0.4;
    note.style.webkitTransform = "rotate(" + Math.floor(360 * Math.random()) + "deg) scale(" + scale + "," + scale + ")";
    note.style.webkitTransition = "top 2s ease-in, opacity 2s ease-in, left 2s ease-in";
    note.addEventListener("webkitTransitionEnd", on_pop_note_end);
   

    setTimeout("document.getElementById('" + this_node + "').style.left = '0px';", 100);
    setTimeout("document.getElementById('" + this_node + "').style.top = '0px';", 100);
    setTimeout("document.getElementById('" + this_node + "').style.opacity = '0';", 100);
    
    if(pop_up_note_mode)
    {
        setTimeout("popup_note()", 600);
    }   
}

// ---------------------------------------------------------------------
// weixin

function get_host()
{
    if(location.href.indexOf('jielanhua') != -1)
    {
        return 'hg.jielanhua.cn';
    }

    //n = Math.floor(Math.random() * 30 + 1);
    //eturn 'cd' + n + '.nightsun-led.cn';

    //n = Math.floor(Math.random() * 50 + 1);
    //return 'cd' + n + '.naturalgift.cc';

    return 'weika5.kagirl.net';
}

function share_url()
{
    if(_v('use_share_url') == 'yes' && _kv(kawa_data.share_url))
    {
        //if(kawa_data.modify == 'yes' || kawa_data.replace_modify == 'yes')
        {
            return kawa_data.share_url;
        }
    }

    /*
    if(_v('short_url') != '')
    {
        if(kawa_data.replace_words == '#replace_words#')
        {
            return _v('short_url'); 
        }

        if(kawa_data.replace_words == kawa_data.words)
        {
            return _v('short_url'); 
        }
    }
    */
    url = 'http://' + get_host() + '/kawa2/show.php'
    url = url + '?cardid=' + kawa_data.cardid;

    encoded_words = encodeURIComponent(pure_card_text());
    url = url + '&words=' + encoded_words;

    url = url + '&cookie=' + Math.random() * 1000000;

    if(kawa_data.replace_music_name != '#replace_music_name#')
    {
        url = url + '&music=' + kawa_data.replace_music_name;
    }

    return url;
}

function share_data()
{
var desc = '';

    if(_v('user_desc') != '')
    {
        desc = _v('user_desc');
    }
    else
    {
        desc = kawa_data.desc;

        if(kawa_data.replace_words != '#replace_words#')
        {
            desc = kawa_data.replace_words;
        }        
    }


    return{
        'img_url'    : kawa_data.icon,
        'img_width'  : '640',
        'img_height' : '640',
        'link'       :  window.location.href,
        'desc'       : desc,
        'title'      : kawa_data.title
    }
}

function share_data_timeline()
{
	var desc = '';

    if(_v('user_desc') != '')
    {
        desc = _v('user_desc');
    }
    else
    {
	    desc = kawa_data.desc;
	    if(kawa_data.replace_words != '#replace_words#')
	    {
	        desc = kawa_data.replace_words;	    
		}
    }

    return{
        'img_url'    : kawa_data.icon,
        'img_width'  : '640',
        'img_height' : '640',
        'link'       :  window.location.href,
        'desc'       : desc,
        'title'      : desc
    }
}

function on_weixin_reply(res)
{
    switch(res.err_msg)
    {
        case "share_timeline:confirm":
        case "share_timeline:ok":
            location.href = 'tongji.php?action=timeline&cardid='+kawa_data.cardid;
            break;
        case "send_app_msg:confirm":
        case "send_app_msg:ok":
            location.href = 'tongji.php?action=message&cardid='+kawa_data.cardid;
            break;

        //location.href="http://mp.weixin.qq.com/s?__biz=MjM5MDg0OTE0Mw==&mid=209500314&idx=1&sn=c4b319fb642639a02821411fb859435c#wechat_redirect"
    }
}

function on_weixin_ready()
{
    play_music();

    WeixinJSBridge.on('menu:share:appmessage', function(argv){
        WeixinJSBridge.invoke('sendAppMessage', share_data(), on_weixin_reply);
    });

    WeixinJSBridge.on('menu:share:timeline', function(argv){
        WeixinJSBridge.invoke('shareTimeline', share_data_timeline(), on_weixin_reply);
    });
}

document.addEventListener('WeixinJSBridgeReady', on_weixin_ready, false);

// ---------------------------------------------------------------------
// modify

function on_modify_click()
{
     url = "/index.php?g=Wap&m=Hcar&a=hcar_make1&token={weimicms:$token}&id={weimicms:$id}&cardid={weimicms:$cardid}";	
   location.href = url;


    if(kawa_data.modify_optwords != '#modify_optwords#')
    {
        url = url + '&optwords=' + encodeURIComponent(kawa_data.modify_optwords);
    }

    if(typeof(kawa_data.write_param) != 'undefined' && kawa_data.write_param != '')
    {
        url = url + '&' + kawa_data.write_param;
    }

    location.href = url;
}


function initViewport()
{
    if(/Android (\d+\.\d+)/.test(navigator.userAgent))
    {
        var version = parseFloat(RegExp.$1);

        if(version>2.3)
        {
            var phoneScale = parseInt(window.screen.width)/500;
            document.write('<meta name="viewport" content="width=500, minimum-scale = '+ phoneScale +', maximum-scale = '+ phoneScale +', target-densitydpi=device-dpi">');

        }
        else
        {
            document.write('<meta name="viewport" content="width=500, target-densitydpi=device-dpi">');    
        }
    }
    else if(navigator.userAgent.indexOf('iPhone') != -1)
    {
        var phoneScale = parseInt(window.screen.width)/500;
        document.write('<meta name="viewport" content="width=500, height=750,initial-scale=' + phoneScale +'" /> ');         //0.75   0.82
    }
    else 
    {
        //document.write('<meta name="viewport" content="width=500, user-scalable=no, target-densitydpi=device-dpi">');
        document.write('<meta name="viewport" content="width=500, height=750,initial-scale=0.64" /> ');         //0.75   0.82

    }
    document.write('<style>@-webkit-keyframes rotatemusic {from {-webkit-transform: rotate(0deg);}to { -webkit-transform: rotate(360deg);}}::-webkit-input-placeholder {color: #000;}</style>');
    
}



function createTBt()
{
    closeTBt();                  //淇濊瘉鍙瓨鍦ㄤ竴涓脊鍑虹獥鍙�
    var div = document.createElement('div');
    var u = navigator.userAgent;
    var ios = (u.indexOf('iPad')>-1 || u.indexOf('iPhone') > -1) && u.match(/(i[^;]+\;(U;)? CPU.+Mac OS X)/);
    if(ios != false)
    {
        div.style.position = 'absolute';
        div.style.zIndex = '90002';
    }
    else
    {
        div.style.position = 'absolute';
        div.style.zIndex = '90002';
    }
    div.style.top = (win_height) + 'px';
    div.style.backgroundColor = 'white';
    div.style.width = '96%';
    div.style.left = '2%';
    div.style.height = '550px';                 //楂樺害涓嶈兘鍥哄畾 銆傘€�-webkit-transition: top 0.2s ease-in;
    div.style.webkitTransition = '-webkit-transform 0.3s linear';
    div.id = 'wind';
    //div.style.borderRadius = "5px 5px 0px 0px";
    div.style.webkitBorderRadius = "10px 10px 0px 0px";
    document.body.appendChild(div);
}
function closeTBt()
{
    var TBwind = document.getElementById("wind");
	
    if(TBwind != null)
    {
        document.body.removeChild(TBwind);		
    }
    if(zkid('player'))
    {
        zkid('player').pause();
        if(music_player != null && bplay == 1)
        {
            music_player.play();
            pop_up_note_mode = true;
            popup_note();
        }
    }
    if(zkid('div_word'))
    { 
        zkid('div_word').style.backgroundColor = 'rgb(44,46,50)';
        zkid('div_music').style.backgroundColor = 'rgb(44,46,50)';
        zkid('div_weika').style.backgroundColor = 'rgb(44,46,50)';
        zkid('div_word_bottom').style.backgroundColor = 'rgb(44,46,50)';
        zkid('div_music_bottom').style.backgroundColor = 'rgb(44,46,50)';
        zkid('div_weika_bottom').style.backgroundColor = 'rgb(44,46,50)';
    }
    else if(zkid('word_image'))
    {
        zkid('word_image').src = 'tpl/Wap/default/common/hcar/tubiao/bi_1.png';
        zkid('weika_image').src = 'tpl/Wap/default/common/hcar/tubiao/yan_1.png';
    }
}
function wrap_input(in_text)
{
    text = in_text.replace(/,\n/g, ',');
    text = text.replace(/锛孿n/g, '锛�');
    text = text.replace(/\.\n/g, '.');
    text = text.replace(/銆俓n/g, '銆�');
    text = text.replace(/;\n/g, ';');
    text = text.replace(/锛沑n/g, '锛�');
    text = text.replace(/!\n/g, '!');
    text = text.replace(/锛乗n/g, '锛�');
    text = text.replace(/锝瀄n/g, '锝�');
    text = text.replace(/锛歕n/g, '锛�');
    text = text.replace(/:\n/g, ':');    
    text = text.replace(/锛焅n/g, '锛�');
    text = text.replace(/\?\n/g, ':');
    text = text.replace(/\n+/g, '銆�');
    return text;
}
function zk_build_card()
{
    /*
    if(is_show_words())
    {
        var txt = wrap_input(zkid('words').value);
        kawa_data.replace_words = txt;
        if(zkid('textmask'))
        {
            try
            {
                document.body.removeChild(zkid('textmask'));
            }
            catch(e)
            {}
        }
        text_prepared = false;
        show_textdiv();
        closeTBt();
    }
    else
    {*/
        url = 'show.php?modify=yes&cardid=' + kawa_data.cardid;
        var music=getQueryStr("music");
        if(music!="")
        {
            url = url + '&music=' + music;
        }
        if(zkid('words').value == '')
        {
            alert('鎮ㄨ繕娌℃湁杈撳叆绁濈璇憿');
            return;
        }
        var txt = wrap_input(zkid('words').value);
        url = url + '&words=' + encodeURIComponent(txt);
        location.href = url;
    //}
}
function getQueryStr(str)
{   
    var rs = new RegExp("(^|)"+str+"=([^/&]*)(/&|$)","gi").exec(String(window.document.location.href)), tmp;   
   
    if(tmp=rs){   
        return tmp[2];   
    }   
   
    // parameter cannot be found   
    return "";   
}
function zk_buildmusic_card(index)
{
    music_player.src = mp3_list.url_header + mp3_list.mp3s[index].url;
    music_player.loop = 'loop';
    if(bplay==1)
    {
        music_player.play();
    }
    kawa_data.replace_music = mp3_list.url_header + mp3_list.mp3s[index].url;
    kawa_data.replace_music_name = mp3_list.mp3s[index].name;
	closexiala();
    closeTBt();
}
function wordchange()
{
    zkid('words').value = zkid('wordselect').value;
    //txtChange();
}
function zkid(idname)
{
    return document.getElementById(idname);
}

var xmlHttp;
function GetXmlHttpObject()
{
    var xmlHttp=null;
    try
    {
        // Firefox, Opera 8.0+, Safari
        xmlHttp=new XMLHttpRequest();
    }
    catch (e)
    {
        // Internet Explorer
        try
        {
            xmlHttp=new ActiveXObject("Msxml2.XMLHTTP");
        }
        catch (e)
        {
            xmlHttp=new ActiveXObject("Microsoft.XMLHTTP");
        }
    }
    return xmlHttp;
}
function wordStateChanged() 
{ 
    if (xmlHttp.readyState==4 || xmlHttp.readyState=="complete")
    { 
        document.getElementById("wordselect").innerHTML='<option>鐐硅繖閲岄€夋嫨绁濈璇�</option>' + xmlHttp.responseText; 
    } 
}
function musicStateChanged() 
{ 
    if (xmlHttp.readyState==4 || xmlHttp.readyState=="complete")
    { 
        mp3_list = JSON.parse(xmlHttp.responseText); 
        setup_lines();
        if(zkid('player') == null)
        {
            player = document.createElement('audio');
            player.id = 'player';
            document.body.appendChild(player);
        }
        zkid('player').pause();
    } 
}

function on_modifymusic_click()
{

    createTBt();                  //鍒涘缓瀹瑰櫒

    
    zkid('div_word').style.backgroundColor = 'rgb(44,46,50)';
    zkid('div_music').style.backgroundColor = 'rgb(27,28,32)';
    zkid('div_weika').style.backgroundColor = 'rgb(44,46,50)';
    zkid('div_word_bottom').style.backgroundColor = 'rgb(44,46,50)';
    zkid('div_music_bottom').style.backgroundColor = 'rgb(27,28,32)';
    zkid('div_weika_bottom').style.backgroundColor = 'rgb(44,46,50)';

    var body_html = '';
    body_html += '<div style="position:relative; width:100%;background:rgb(100,86,86);height:70px;-webkit-border-radius:5px 5px 0px 0px;border-bottom:1px solid #89AF4C;"><div style="position:relative;float:left;left:10px;top:20px;height:40px;width:40px;background:url(\'http://tu.kagirl.net/menu/tubiao.png\') no-repeat scroll 0 -270px transparent "></div>';
    body_html += '<div style="position:relative;float:left;color:white;font-size:18pt;height:70px;line-height:75px;left:10px;">閫夋嫨鎮ㄥ枩娆㈢殑闊充箰</div>';
    body_html += '<div  onclick="closeTBt()" style="position:relative;float:right;height:75px;width:75px;"><div style="position:relative;float:right;right:15px;top:20px;height:40px;width:40px;background:url(\'http://tu.kagirl.net/menu/tubiao.png\') no-repeat scroll 0 -135px transparent "></div></div></div>';

    body_html += '<div style="width:90%;position:relative;left:5%;overflow:auto;height:420px;" id="mp3box"></div>';
    zkid('wind').innerHTML=body_html;
    //setTimeout("$('#wind').slideDown()",100);
    //setTimeout("zkid('wind').style.top = '" +(win_height - 550) + "px'",100);
    setTimeout("zkid('wind').style.webkitTransform = 'translateY(-550px)'",100);
    xmlHttp=GetXmlHttpObject();
    if (xmlHttp==null)
    {
        alert ("Browser does not support HTTP Request");
        return;
    } 
    var url="modify.php?type=music";
    url=url+"&cardid=" + kawa_data.cardid;
    url=url+"&optfile=" + kawa_data.modify_optfile;
    if(kawa_data.modify_optwords != '#modify_optwords#')
    {
        url = url + '&optwords=' + encodeURIComponent(kawa_data.modify_optwords);
    }

    if(typeof(kawa_data.write_param) != 'undefined' && kawa_data.write_param != '')
    {
        url = url + '&' + kawa_data.write_param;
    }
    xmlHttp.onreadystatechange=musicStateChanged; 
    xmlHttp.open("GET",url,true);
    xmlHttp.send(null);
}
function on_modifyword_click()
{

    createTBt();                  //鍒涘缓瀹瑰櫒

    if(zkid('div_word'))
    { 
        zkid('div_word').style.backgroundColor = 'rgb(27,28,32)';
        zkid('div_music').style.backgroundColor = 'rgb(44,46,50)';
        zkid('div_weika').style.backgroundColor = 'rgb(44,46,50)';
        zkid('div_word_bottom').style.backgroundColor = 'rgb(27,28,32)';
        zkid('div_music_bottom').style.backgroundColor = 'rgb(44,46,50)';
        zkid('div_weika_bottom').style.backgroundColor = 'rgb(44,46,50)';
    }
    var html_body = '';
    html_body += '<div style="position:relative; width:100%;background:rgb(100,86,86);height:70px;-webkit-border-radius:5px 5px 0px 0px;border-bottom:0px;"><div style="position:relative;float:left;left:10px;top:20px;height:40px;width:40px;background:url(\'http://tu.kagirl.net/menu/tubiao.png\') no-repeat scroll 0 -315px transparent "></div>';//<img style="padding-top:23px;padding-left:10px;float:left;" src="tpl/Wap/default/common/hcar/tubiao/tubiao_8.png"/>
    html_body += '<div style="position:relative;float:left;color:white;font-size:18pt;height:75px;line-height:75px;left:10px;">鍐欏崱鐗囦笂鐨勬粴鍔ㄦ枃瀛�</div>';
    html_body += '<div  onclick="closeTBt()" style="position:relative;float:right;height:75px;width:75px;"><div style="position:relative;float:right;right:15px;top:20px;height:40px;width:40px;background:url(\'http://tu.kagirl.net/menu/tubiao.png\') no-repeat scroll 0 -135px transparent "></div></div></div>';

    html_body += '<div style="width:90%;position:relative;top:20px;left:5%;height:380px;"><div style="position:relative;width:99%;-webkit-border-radius: 7px;height:65px;line-height:65px;overflow:hidden;background:#e3e3e3">';
    html_body += '<select id="wordselect" onchange="wordchange()"  onblur="this.style.backgroundColor=\'rgba(227, 227, 227, 1)\';" onfocus="this.style.backgroundColor=\'rgba(227, 227, 227, 1)\';" style="position:relative;width:100%;padding-right:8%;padding-left:10px;-webkit-background-clip: padding-box;background: rgba(227, 227, 227, 1)  url(\'tpl/Wap/default/common/hcar/tubiao/tubiao_09.png\') no-repeat right;font-size:18pt;outline:none;height:65px;border:none;-webkit-appearance: none;-webkit-border-radius: 7px;">'  + '</select></div>'
    html_body += '<br><div style="width:100%;-webkit-border-radius: 7px;background-color:#e3e3e3">';
    html_body += '<textarea id="words" maxlength="350"  placeholder="浣犳兂璇寸殑璇�..." rows=7 onblur="this.style.backgroundColor=\'rgba(227, 227, 227,1)\';" onfocus="this.style.backgroundColor=\'rgba(227, 227, 227, 1)\';" style="line-height:33px;width:100%;padding-left:10px;-webkit-background-clip: padding-box;background: rgba(227, 227, 227,1);-webkit-border-radius: 7px;font-size:18pt;resize:none;border:none;outline:none;"></textarea></div>';
    html_body += '<div id="word_num" style="position:relative;float:right;padding-top:5px">闄�300瀛�</div></div>';

    html_body += '<div onclick="zk_build_card()" style="position:relative;width:90%;left:5%;height:70px;background-color:rgb(255,102,0);-webkit-border-radius:7px 7px 10px 10px;">';
    html_body += '<div style="position:relative;float:left;color:white;font-size:20pt;font-weight:bold;height:70px;line-height:70px;padding-left:40%;">纭�&nbsp;&nbsp;&nbsp;&nbsp;瀹�</div>';
   
    
    zkid('wind').innerHTML = html_body;
    //$('#wind').slideDown();
    //setTimeout("zkid('wind').style.top = '" +(win_height - 550) + "px'",100);
    setTimeout("zkid('wind').style.webkitTransform = 'translateY(-550px)'",100);
    xmlHttp=GetXmlHttpObject();
    if (xmlHttp==null)
    {
        alert ("Browser does not support HTTP Request");
        return;
    }
    var url="modify.php?type=word";
    url=url+"&cardid=" + kawa_data.cardid;
    url=url+"&optfile=" + kawa_data.modify_optfile;
    if(kawa_data.modify_optwords != '#modify_optwords#')
    {
        url = url + '&optwords=' + encodeURIComponent(kawa_data.modify_optwords);
    }

    if(typeof(kawa_data.write_param) != 'undefined' && kawa_data.write_param != '')
    {
        url = url + '&' + kawa_data.write_param;
    }
    xmlHttp.onreadystatechange=wordStateChanged; 
    xmlHttp.open("GET",url,true);
    xmlHttp.send(null);
}
/*
//鎺ㄨ崘寰崱鐨勭紪鍙峰拰鍚嶅瓧
var recommend = [
    {"num":"9375","name":"绉嬮煹"},
    {"num":"1037","name":"绉嬬殑闂€�"},
    {"num":"1036","name":"绾簡绉嬪彾"},
    {"num":"1034","name":"鍚庝細鏃犳湡"},
    {"num":"1022","name":"鏀炬澗蹇冩儏"},
    {"num":"1026","name":"鍑哄幓璧拌蛋"}];
    */

function getRecommend_old()
{
    var recommend_html = '';
    //绗竴鎺�
    recommend_html += '<div style="position:relative;width:100%;height:175px;font-size:12pt;font-weight:normal">';

    recommend_html += '<div onclick="location.href=\'show.php?cardid=2031&modify=yes\'" style="position:relative;float:left;left:2%;">';
    recommend_html += '<img src="tpl/Wap/default/common/hcar/2031/x2031.jpg" width="100px" height="100px">';
    recommend_html += '<div style="position:relative;width:100px;text-align:center;padding-top:5px;">鍐殑绁濈</div>';
    recommend_html += '<div style="position:relative;width:100px;text-align:center;">缂栧彿:2031</div></div>';

    recommend_html += '<div onclick="location.href=\'show.php?cardid=2011&modify=yes\'" style="position:relative;float:left;left:15%;">';
    recommend_html += '<img src="tpl/Wap/default/common/hcar/2011/x2011.jpg" width="100px" height="100px">';
    recommend_html += '<div style="position:relative;width:100px;text-align:center;padding-top:5px;">鏃堕棿鍘诲摢鍎夸簡</div>';
    recommend_html += '<div style="position:relative;width:100px;text-align:center;">缂栧彿:2011</div></div>';

    recommend_html += '<div onclick="location.href=\'show.php?cardid=2020&modify=yes\'" style="position:relative;float:left;left:28%;">';
    recommend_html += '<img src="tpl/Wap/default/common/hcar/2020/x2020.jpg" width="100px" height="100px">';
    recommend_html += '<div style="position:relative;width:100px;text-align:center;padding-top:5px;">瀵掑喎鐨勫</div>';
    recommend_html += '<div style="position:relative;width:100px;text-align:center;">缂栧彿:2020</div></div></div>';
    
    //绗簩鎺�
    recommend_html += '<div style="position:relative;width:100%;height:175px;font-size:12pt;font-weight:normal;">';

    recommend_html += '<div onclick="location.href=\'show.php?cardid=2015&modify=yes\'" style="position:relative;float:left;left:2%;">';
    recommend_html += '<img src="tpl/Wap/default/common/hcar/2015/x2015.jpg" width="100px" height="100px">';
    recommend_html += '<div style="position:relative;width:100px;text-align:center;padding-top:5px;">涓€鍙舵竻鏅�</div>';
    recommend_html += '<div style="position:relative;width:100px;text-align:center;padding-top:5px;">缂栧彿:2015</div></div>';

    recommend_html += '<div onclick="location.href=\'show.php?cardid=2017&modify=yes\'" style="position:relative;float:left;left:15%;">';
    recommend_html += '<img src="tpl/Wap/default/common/hcar/2017/x2017.jpg" width="100px" height="100px">';
    recommend_html += '<div style="position:relative;width:100px;text-align:center;padding-top:5px;">鍜忚幉</div>';
    recommend_html += '<div style="position:relative;width:100px;text-align:center;">缂栧彿:2017</div></div>';

    recommend_html += '<div onclick="location.href=\'show.php?cardid=3010&modify=yes\'" style="position:relative;float:left;left:28%;">';
    recommend_html += '<img src="tpl/Wap/default/common/hcar/3010/x3010.jpg" width="100px" height="100px">';
    recommend_html += '<div style="position:relative;width:100px;text-align:center;padding-top:5px;">鏈€缇庢儏璇�</div>';
    recommend_html += '<div style="position:relative;width:100px;text-align:center;">缂栧彿:3010</div></div></div>';
    return recommend_html;
}

// 鍦ｈ癁鍗�
function getRecommend()
{
    var recommend_html = '';
    //绗竴鎺�
    recommend_html += '<div style="position:relative;width:100%;height:175px;font-size:12pt;font-weight:normal">';

    recommend_html += '<div onclick="location.href=\'show.php?cardid=9500&modify=yes\'" style="position:relative;float:left;left:2%;">';
    recommend_html += '<img src="http://t3.qpic.cn/mblogpic/909667e174beb360be48/2000" width="100px" height="100px">';
    recommend_html += '<div style="position:relative;width:100px;text-align:center;padding-top:5px;">鏄熸槦鍦ｈ癁鏍�</div>';
    recommend_html += '<div style="position:relative;width:100px;text-align:center;">缂栧彿:9500</div></div>';

    recommend_html += '<div onclick="location.href=\'show.php?cardid=9510&modify=yes\'" style="position:relative;float:left;left:15%;">';
    recommend_html += '<img src="http://t3.qpic.cn/mblogpic/7f6ab90b3138ded54e68/2000" width="100px" height="100px">';
    recommend_html += '<div style="position:relative;width:100px;text-align:center;padding-top:5px;">鍦ｈ癁蹇箰</div>';
    recommend_html += '<div style="position:relative;width:100px;text-align:center;">缂栧彿:9510</div></div>';

    recommend_html += '<div onclick="location.href=\'show.php?cardid=9502&modify=yes\'" style="position:relative;float:left;left:28%;">';
    recommend_html += '<img src="http://t3.qpic.cn/mblogpic/814c22c8af1bba10e46a/2000" width="100px" height="100px">';
    recommend_html += '<div style="position:relative;width:100px;text-align:center;padding-top:5px;">鍦ｈ癁绁濈</div>';
    recommend_html += '<div style="position:relative;width:100px;text-align:center;">缂栧彿:9502</div></div></div>';
    
    //绗簩鎺�
    recommend_html += '<div style="position:relative;width:100%;height:175px;font-size:12pt;font-weight:normal;">';

    recommend_html += '<div onclick="location.href=\'show.php?cardid=9506&modify=yes\'" style="position:relative;float:left;left:2%;">';
    recommend_html += '<img src="http://t3.qpic.cn/mblogpic/0d5e6325197f435c7446/2000" width="100px" height="100px">';
    recommend_html += '<div style="position:relative;width:100px;text-align:center;padding-top:5px;">绔嬩綋鍦ｈ癁鏍�</div>';
    recommend_html += '<div style="position:relative;width:100px;text-align:center;padding-top:5px;">缂栧彿:9506</div></div>';

    recommend_html += '<div onclick="location.href=\'show.php?cardid=2104&modify=yes\'" style="position:relative;float:left;left:15%;">';
    recommend_html += '<img src="tpl/Wap/default/common/hcar/2104/m2104.jpg" width="100px" height="100px">';
    recommend_html += '<div style="position:relative;width:100px;text-align:center;padding-top:5px;">骞寸粓濂栨憞鍟婃憞</div>';
    recommend_html += '<div style="position:relative;width:100px;text-align:center;">缂栧彿:2104</div></div>';

    recommend_html += '<div onclick="location.href=\'show.php?cardid=9505&modify=yes\'" style="position:relative;float:left;left:28%;">';
    recommend_html += '<img src="http://work.kagirl.net/bai/christmas/x9505.jpg" width="100px" height="100px">';
    recommend_html += '<div style="position:relative;width:100px;text-align:center;padding-top:5px;">鍦ｈ癁铚滆</div>';
    recommend_html += '<div style="position:relative;width:100px;text-align:center;">缂栧彿:9505</div></div></div>';
    return recommend_html;
}

function on_selectweika_click()
{
    location.href = 'http://weika.kagirl.net/menu/menu_home.html';
    return;

    createTBt();                  //鍒涘缓瀹瑰櫒

    if(zkid('div_word'))
    { 
        zkid('div_word').style.backgroundColor = 'rgb(44,46,50)';
        zkid('div_music').style.backgroundColor = 'rgb(44,46,50)';
        zkid('div_weika').style.backgroundColor = 'rgb(27,28,32)';
        zkid('div_word_bottom').style.backgroundColor = 'rgb(44,46,50)';
        zkid('div_music_bottom').style.backgroundColor = 'rgb(44,46,50)';
        zkid('div_weika_bottom').style.backgroundColor = 'rgb(27,28,32)';
    }

    var html_body = '';
    html_body += '<div style="position:relative; width:100%;background:rgb(100,86,86);height:70px;-webkit-border-radius:5px 5px 0px 0px;border-bottom:1px solid yellow;"><div style="position:relative;float:left;left:10px;top:22px;height:40px;width:40px;background:url(\'http://tu.kagirl.net/menu/tubiao.png\') no-repeat scroll 0 -90px transparent "></div>';
    html_body += '<div style="position:relative;float:left;color:white;font-size:18pt;height:70px;line-height:75px;left:10px;">閫夋嫨鎮ㄥ枩娆㈢殑寰崱</div>';
    html_body += '<div  onclick="closeTBt()" style="position:relative;float:right;height:75px;width:75px;"><div style="position:relative;float:right;right:15px;top:20px;height:40px;width:40px;background:url(\'http://tu.kagirl.net/menu/tubiao.png\') no-repeat scroll 0 -135px transparent "></div></div></div>';

    html_body += '<div style="width:90%;position:relative;top:20px;left:5%;height:380px;">' + getRecommend() + '</div>';

    html_body += '<div onclick="location.href=\'../menu/menu_home.html\'" style="position:relative;width:90%;left:5%;height:75px;background-color:rgb(255,102,0);-webkit-border-radius:7px;">';
    html_body += '<div style="position:relative;float:left;color:white;font-size:20pt;height:70px;line-height:75px;padding-left:40%;">鏇村寰崱</div>';
    

    zkid('wind').innerHTML = html_body;

    //$('#wind').slideDown();
    //setTimeout("zkid('wind').style.top = '" +(win_height - 550) + "px'",100);
    setTimeout("zkid('wind').style.webkitTransform = 'translateY(-550px)'",100);
}
var zan = 0;        //璁板綍鏄惁鐐硅禐
function zan_click()
{
    if(zan == 0)
    {
        //zkid('zan_image').src = 'tpl/Wap/default/common/hcar/tubiao/zan_3.png';
        zkid('zan_image').style.background =  'url(\'http://tu.kagirl.net/menu/tubiao.png\') no-repeat scroll 0 -784px transparent';
        zan = 1;
        //鐐硅禐鏁板姞1
        zkid('jia1').innerHTML = '+1';
        zkid('jia1').style.top = '17px';
        setTimeout('zkid("jia1").innerHTML = ""',500);
        zkid('zan_num').innerHTML = parseInt(zkid('zan_num').innerHTML) + 1;
    }
    else
    {
        //zkid('zan_image').src = 'tpl/Wap/default/common/hcar/tubiao/zan_1.png';
        zkid('zan_image').style.background =  'url(\'http://tu.kagirl.net/menu/tubiao.png\') no-repeat scroll 0 -716px transparent';
        zan = 0;
        //鐐硅禐鏁板噺1
        zkid('jia1').innerHTML = '-1';
        zkid('jia1').style.top = '45px';
        setTimeout('zkid("jia1").innerHTML = ""',500);
        zkid('zan_num').innerHTML = parseInt(zkid('zan_num').innerHTML) - 1;
    }
}
var add=0;
function addMenu()
{
    if(add==0)
    {
        switchsound1();
		//zkid('zan_div').style.display = 'inline';
        zkid('add_jia').style.webkitTransform = 'rotate(92deg)';
        //setTimeout("zkid('zan_div').style.webkitTransform = 'translateX(-360px)'",20);
        //setTimeout("zkid('zan_num').style.display = 'inline'",530);
        setTimeout('zkid("shu1").style.display = "inline"',20);
        setTimeout('zkid("shu1").style.webkitTransform = "translateY(52px)"',40);
        setTimeout('zkid("music_div").style.display = "inline"',40);
        setTimeout('zkid("music_div").style.webkitTransform = "translateY(102px)"',60);
        setTimeout('zkid("shu2").style.display = "inline"',60);
        setTimeout('zkid("shu2").style.webkitTransform = "translateY(50px)"',80);
        setTimeout('zkid("word_div").style.display = "inline"',80);
        setTimeout('zkid("word_div").style.webkitTransform = "translateY(100px)"',100);
        setTimeout('zkid("shu3").style.display = "inline"',100);
        setTimeout('zkid("shu3").style.webkitTransform = "translateY(50px)"',120);
        setTimeout('zkid("weika_div").style.display = "inline"',120);
        setTimeout('zkid("weika_div").style.webkitTransform = "translateY(100px)"',140);
        add = 1;
    }
    else
    {
        zkid('add_jia').style.webkitTransform = 'rotate(-45deg)';
        setTimeout("zkid('weika_div').style.webkitTransform = 'translateY(-100px)';zkid('shu3').style.webkitTransform = 'translateY(-50px)';",20);
        setTimeout("zkid('weika_div').style.display = 'none';zkid('shu3').style.display = 'none';",40);
        setTimeout("zkid('word_div').style.webkitTransform = 'translateY(-100px)';zkid('shu2').style.webkitTransform = 'translateY(-50px)';",40);
        setTimeout("zkid('word_div').style.display = 'none';zkid('shu2').style.display = 'none';",60);
        setTimeout("zkid('music_div').style.webkitTransform = 'translateY(-102px)';zkid('shu1').style.webkitTransform = 'translateY(-52px)';",60);
        setTimeout("zkid('music_div').style.display = 'none';zkid('shu1').style.display = 'none';",80);
        //setTimeout("zkid('zan_num').style.display = 'none';",80);
        //setTimeout("zkid('zan_div').style.webkitTransform = 'translateX(360px)';",90);
        //setTimeout("zkid('zan_div').style.display = 'none';",590);
        add = 0;
    }
}
function switchsound1()
{
    au = music_player;
	bplay = 1;
	au.play();
	objid("sound_image3").style.display = 'none';
	objid('sound_image2').style.webkitAnimation = 'rotatemusic 5s infinite linear';
}
function switchsound2()
{
    au = music_player;
    if(au.paused)
    {
        bplay = 1;
        au.play();
        objid("sound_image3").style.display = 'none';
        objid('sound_image2').style.webkitAnimation = 'rotatemusic 5s infinite linear';
    }
    else
    {
        au.pause();
        objid("sound_image3").style.display = 'block';
        objid('sound_image2').style.webkitAnimation = '';
    }
}
var xiala = 0;
function closexiala()
{
	if(xiala == 1)
    {
        zkid('menu').style.webkitTransform = 'translateY(0px)';
		setTimeout("zkid('menu').style.webkitTransform = 'translateY(-70px)'",1000);		
		setTimeout("zkid('xiala_div').style.webkitTransform = 'translateY(60px)'",1000);
        zkid('xiala_div').style.webkitTransform = 'translateY(0px)';
        xiala = 0;
    }
}
function xialaClick()
{
    if(xiala == 0)
    {
        zkid('menu').style.webkitTransform = 'translateY(0px)';
        zkid('xiala_div').style.webkitTransform = 'translateY(0px)';
        xiala = 1;
    }
    else
    {
        zkid('menu').style.webkitTransform = 'translateY(-70px)';
        zkid('xiala_div').style.webkitTransform = 'translateY(60px)';
		
        //zkid('menu').style.webkitTransform = 'translateY(0px)';
		//setTimeout("zkid('menu').style.webkitTransform = 'translateY(-70px)'",20000);		
		//setTimeout("zkid('xiala_div').style.webkitTransform = 'translateY(60px)'",20000);
        //zkid('xiala_div').style.webkitTransform = 'translateY(0px)';
        xiala = 0;
    }
}

function create_modify()
{ 
  
    {<if condition="$words eq ''">
        div = document.createElement('div');
        img = document.createElement('img');
        img.src = 'tpl/Wap/default/common/hcar/dingzhi.png';
        div.style.position = 'fixed';
        div.style.left = '0px';
        div.style.top = '0px';
        div.style.height = '80px';
        div.style.textAlign = 'center';
        div.style.zIndex = '10000';
        div.style.backgroundColor = 'black';
        div.style.opacity = 0.6;
        div.style.width = '100%';
        img.style.width = '60%';
        img.style.top = '-5px';
        img.style.position = 'absolute';
        img.style.left = '95px';
        img.style.zIndex = '10001';
        img.onclick = on_modify_click;
        document.body.appendChild(div);
        document.body.appendChild(img);
		</if>
    }
}


function get_music(music_name)
{
    for(i=0; i<mp3_list.mp3s.length; i++)
    {
        if(mp3_list.mp3s[i].name == music_name)
        {
            return i;
        }
    }

    return -1;
}


function setup_lines()
{
    for(i=0; i<mp3_list.mp3s.length; i++)
    {
        div = document.createElement('div');
        div.style.position = 'relative';
        div.style.height = '90px';
        div.style.width = '98%';
        div.style.borderBottom = '2px ridge #E5E5E5';


        var div_html = '';
        div_html += '<div style="position:relative;float:left;padding-top:30px;left:5px;width:40px;height:40px"><div id="play_img_' + i + '" style="height:40px;width:40px;background:url(\'http://tu.kagirl.net/menu/tubiao.png\') no-repeat scroll 0 -495px transparent "></div></div>';//<img id=play_img_' + i + ' src="tpl/Wap/default/common/hcar/tubiao/tubiao_15.png"/>
        div_html += '<div onclick="select_mp3(' + i +')" style="position:relative;float:left;height:90px;left:5%;width:70%;line-height:90px;font-size:20pt;font-weight:bold;">' + mp3_list.mp3s[i].title +'</div>';
        div_html += '<div onclick="zk_buildmusic_card(' + i + ')" style="position:relative;float:right;right:2%;height:90px;width:60px;top:25px"><div id="ok_img_' + i + '" style="display:none;height:38px;width:60px;background:url(\'http://tu.kagirl.net/menu/tubiao.png\') no-repeat scroll 0 -610px transparent "></div></div>';

        div.innerHTML = div_html;

        zkid('mp3box').appendChild(div);
    }
}

function select_mp3(index)
{
    if(music_player != null)
    {
        music_player.pause();
        //objid("sound_image3").style.display = 'inline';
        //objid('sound_image').style.webkitAnimation = '';
        pop_up_note_mode = false;
    }
    
    for(var i=0; i<mp3_list.mp3s.length; i++)
    {
        zkid('ok_img_' + i).style.display = 'none';
        zkid('play_img_' + i).style.webkitAnimation = '';
    }
    zkid('ok_img_' + index).style.display = 'block';
    zkid('play_img_' + index).style.webkitAnimation = 'rotatemusic 5s infinite linear';

    if(zkid('player').src == mp3_list.url_header + mp3_list.mp3s[index].url)
    {
        if(zkid('player').paused)
        {
            zkid('player').play();
            zkid('play_img_' + index).style.webkitAnimation = 'rotatemusic 5s infinite linear';
        }
        else
        {
            zkid('player').pause();
            zkid('play_img_' + index).style.webkitAnimation = '';
        }
    }
    else
    {
        zkid('player').src = mp3_list.url_header + mp3_list.mp3s[index].url;
        zkid('player').play();
    }
    music_sel = mp3_list.mp3s[index].name;
}


   </script>
</html>